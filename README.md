### TODO
- Thread support
    - waiting_clients may have RACE issue
- timeout support
